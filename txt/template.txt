// ========== template.pde ==========

// ML 입력 개수 설정
final int NUM_DRUM_FEATURES   = 3;
final int NUM_GUITAR_FEATURES = 4;
final int NUM_VOCAL_FEATURES  = 4;
final int NUM_INPUTS = NUM_DRUM_FEATURES + NUM_GUITAR_FEATURES + NUM_VOCAL_FEATURES;

final int DRUM_OFFSET   = 0;
final int GUITAR_OFFSET = DRUM_OFFSET + NUM_DRUM_FEATURES;
final int VOCAL_OFFSET  = GUITAR_OFFSET + NUM_GUITAR_FEATURES;

float[] inputVector = new float[NUM_INPUTS];

String[] GENRE_NAMES = { "Jazz", "HipHop", "Cinematic" };

int drumGenre = 0;
int guitarGenre = 0;
int vocalGenre = 0;

// 초기화 함수
void initInputVector() {
  for (int i = 0; i < NUM_INPUTS; i++) inputVector[i] = 0;
}

// 센서 → Feature 벡터
void updateFeaturesFromSensors() {
  // MotionReceiver 값 사용 예시
  inputVector[DRUM_OFFSET + 0] = 0;
  inputVector[DRUM_OFFSET + 1] = max(0, -motion.ay);
  inputVector[DRUM_OFFSET + 2] = 0;

  // 기타/보컬도 그대로 유지
}

// Wekinator로 보내기
void sendInputsToWekinator() {
  OscMessage msg = new OscMessage("/wek/inputs");
  for (int i = 0; i < NUM_INPUTS; i++) msg.add(inputVector[i]);
  osc.send(msg, wek);
}

// Wekinator 출력 처리
void handleWekinatorOutput(OscMessage m) {
  if (m.arguments().length >= 3) {
    drumGenre   = constrain(round(m.get(0).floatValue()), 0, 2);
    guitarGenre = constrain(round(m.get(1).floatValue()), 0, 2);
    vocalGenre  = constrain(round(m.get(2).floatValue()), 0, 2);
  }
}

// 디버그 화면
void drawDebugUI() {
  textAlign(LEFT, TOP);
  fill(255);
  textSize(20);
  text("Trio Loop Machine – ML Template", 30, 20);
  // (생략: 기존 텍스트 UI 그대로)
}
